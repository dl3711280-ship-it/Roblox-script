local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local UserInputService = game:GetService("UserInputService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0,100,0,40)
ToggleButton.Position = UDim2.new(0,10,0,10)
ToggleButton.BackgroundColor3 = Color3.fromRGB(0,200,0)
ToggleButton.Text = "BodyLock OFF"
ToggleButton.Parent = ScreenGui

local FovBox = Instance.new("TextBox")
FovBox.Size = UDim2.new(0,100,0,40)
FovBox.Position = UDim2.new(0,10,0,60)
FovBox.BackgroundColor3 = Color3.fromRGB(0,255,0)
FovBox.Text = "60"
FovBox.Parent = ScreenGui

local Circle = Instance.new("Frame")
Circle.Size = UDim2.new(0,0,0,0)
Circle.Position = UDim2.new(0.5,0,0.5,0)
Circle.AnchorPoint = Vector2.new(0.5,0.5)
Circle.BackgroundTransparency = 1
Circle.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(1,0)
UICorner.Parent = Circle

local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 2
UIStroke.Color = Color3.fromRGB(0,255,0)
UIStroke.Parent = Circle

local enabled = false
local fov = 60

ToggleButton.MouseButton1Click:Connect(function()
	enabled = not enabled
	ToggleButton.Text = enabled and "BodyLock ON" or "BodyLock OFF"
end)

FovBox.FocusLost:Connect(function()
	local num = tonumber(FovBox.Text)
	if num then
		fov = num
	end
end)

local function getClosestNPC()
	local closest = nil
	local closestDist = fov
	for _,npc in ipairs(workspace:GetChildren()) do
		if npc:FindFirstChild("Humanoid") and npc:FindFirstChild("HumanoidRootPart") and not Players:GetPlayerFromCharacter(npc) then
			local pos, onscreen = Camera:WorldToViewportPoint(npc.HumanoidRootPart.Position)
			if onscreen then
				local dist = (Vector2.new(pos.X,pos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
				if dist < closestDist then
					closestDist = dist
					closest = npc
				end
			end
		end
	end
	return closest
end

RunService.RenderStepped:Connect(function()
	Circle.Size = UDim2.new(0,fov*6,0,fov*6)
	if enabled then
		local npc = getClosestNPC()
		if npc and npc:FindFirstChild("HumanoidRootPart") then
			Camera.CFrame = CFrame.new(Camera.CFrame.Position, npc.HumanoidRootPart.Position)
		end
	end
end)
