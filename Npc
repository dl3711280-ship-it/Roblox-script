local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera
local LocalPlayer = game.Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HRP = Character:WaitForChild("HumanoidRootPart")

local aiming = false
local FOV = 50

local Circle = Drawing.new("Circle")
Circle.Thickness = 2
Circle.NumSides = 64
Circle.Radius = FOV
Circle.Filled = false
Circle.Color = Color3.fromRGB(0,255,0)
Circle.Transparency = 1

RunService.RenderStepped:Connect(function()
    Circle.Position = UserInputService:GetMouseLocation()
    Circle.Radius = FOV
end)

local function GetClosestNPC()
    local closest, distance = nil, FOV
    for _, npc in pairs(workspace:GetChildren()) do
        if npc:FindFirstChild("HumanoidRootPart") and npc:FindFirstChildOfClass("Humanoid") then
            local pos, onScreen = Camera:WorldToViewportPoint(npc.HumanoidRootPart.Position)
            if onScreen then
                local mag = (Vector2.new(pos.X, pos.Y) - UserInputService:GetMouseLocation()).Magnitude
                if mag < distance then
                    distance = mag
                    closest = npc
                end
            end
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function()
    if aiming then
        local npc = GetClosestNPC()
        if npc and npc:FindFirstChild("HumanoidRootPart") then
            HRP.CFrame = CFrame.new(HRP.Position, Vector3.new(npc.HumanoidRootPart.Position.X, HRP.Position.Y, npc.HumanoidRootPart.Position.Z))
        end
    end
end)

local ScreenGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
local Toggle = Instance.new("TextButton", ScreenGui)
Toggle.Size = UDim2.new(0,100,0,40)
Toggle.Position = UDim2.new(0,10,0,10)
Toggle.Text = "BodyLock OFF"
Toggle.BackgroundColor3 = Color3.fromRGB(0,255,0)

Toggle.MouseButton1Click:Connect(function()
    aiming = not aiming
    Toggle.Text = aiming and "BodyLock ON" or "BodyLock OFF"
end)

local Box = Instance.new("TextBox", ScreenGui)
Box.Size = UDim2.new(0,100,0,40)
Box.Position = UDim2.new(0,10,0,60)
Box.Text = tostring(FOV)
Box.BackgroundColor3 = Color3.fromRGB(0,255,0)

Box.FocusLost:Connect(function()
    local val = tonumber(Box.Text)
    if val then
        FOV = val
    end
end)
