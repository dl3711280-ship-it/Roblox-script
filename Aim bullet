local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

local aimEnabled = false
local fov = 50

local ScreenGui = Instance.new("ScreenGui", player.PlayerGui)

local ToggleButton = Instance.new("TextButton", ScreenGui)
ToggleButton.Size = UDim2.new(0, 140, 0, 50)
ToggleButton.Position = UDim2.new(0, 20, 0, 200)
ToggleButton.Text = "BodyLock: OFF"
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleButton.TextColor3 = Color3.new(1,1,1)
ToggleButton.TextScaled = true
ToggleButton.BorderSizePixel = 0
ToggleButton.AutoButtonColor = true

local FOVBox = Instance.new("TextBox", ScreenGui)
FOVBox.Size = UDim2.new(0, 100, 0, 40)
FOVBox.Position = UDim2.new(0, 20, 0, 260)
FOVBox.PlaceholderText = "FOV"
FOVBox.Text = tostring(fov)
FOVBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
FOVBox.TextColor3 = Color3.new(1,1,1)
FOVBox.TextScaled = true
FOVBox.BorderSizePixel = 0

local FOVCircle = Drawing.new("Circle")
FOVCircle.Visible = true
FOVCircle.Color = Color3.fromRGB(0,255,0)
FOVCircle.Thickness = 2
FOVCircle.NumSides = 50
FOVCircle.Filled = false
FOVCircle.Radius = fov
FOVCircle.Position = workspace.CurrentCamera.ViewportSize/2

ToggleButton.MouseButton1Click:Connect(function()
    aimEnabled = not aimEnabled
    ToggleButton.Text = aimEnabled and "BodyLock: ON" or "BodyLock: OFF"
end)

FOVBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        local val = tonumber(FOVBox.Text)
        if val and val > 0 then
            fov = val
        else
            FOVBox.Text = tostring(fov)
        end
    end
end)

mouse.Button1Down:Connect(function()
    if aimEnabled then
        local closest,dist
        for _,v in pairs(Players:GetPlayers()) do
            if v ~= player and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
                local hrp = v.Character.HumanoidRootPart
                local pos,vis = workspace.CurrentCamera:WorldToViewportPoint(hrp.Position)
                if vis then
                    local mag = (Vector2.new(pos.X,pos.Y) - (workspace.CurrentCamera.ViewportSize/2)).Magnitude
                    if mag < fov then
                        if not dist or mag < dist then
                            dist = mag
                            closest = hrp
                        end
                    end
                end
            end
        end
        if closest then
            mouse.TargetFilter = closest.Parent
        end
    end
end)

RunService.RenderStepped:Connect(function()
    FOVCircle.Position = workspace.CurrentCamera.ViewportSize/2
    FOVCircle.Radius = fov
end)
